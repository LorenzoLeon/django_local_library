<!DOCTYPE html>
<div id="myplot"></div>
<script src="https://cdn.jsdelivr.net/npm/d3@7"></script>
<script src="https://cdn.jsdelivr.net/npm/@observablehq/plot@0.6"></script>
<script type="module">
const us = await d3.json("http://127.0.0.1:7000/static/assets/us-counties-10m.json", function (err, us) {
                    console.log(us)
                 });
const counties_raw = topojson.feature(us, us.objects.counties);
const rate = await d3.csv("http://127.0.0.1:7000/static/assets/us-county-unemployment.csv");
const map = new Map(rate.map((d) => [d.id, +d.rate]));
counties_raw.features.forEach((g) => {
    g.properties.unemployment = map.get(g.id);
}); 
const counties = counties_raw.features;
const plot = Plot.plot({
    projection: "albers-usa",
    color: {
        type: "quantile",
        n: 9,
        scheme: "blues",
        label: "Unemployment (%)",
        legend: true
    },
    marks: [
        Plot.geo(counties, {
            fill: "unemployment",
            title: (d) => `${d.properties.name} ${d.properties.unemployment}%`,
            tip: true
        })
    ]
});
console.log(plot)
/*const plot = Plot.rectY({length: 10000}, Plot.binX({y: "count"}, {x: Math.random})).plot();*/
const div = document.querySelector("#myplot");
div.append(plot);

</script>